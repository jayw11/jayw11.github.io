<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title> mobility </title>
    <link rel="stylesheet" href="styles.css">
    <!-- <link rel="stylesheet" type="text/css" href="multiline.css"> -->
    <script src="https://d3js.org/d3.v4.min.js" charset="utf-8"></script>
    <script src="https://rawgit.com/susielu/d3-annotation/master/d3-annotation.min.js"></script>
</head>
<body bgcolor="#FAFFF0">
    <center>
        <p style="font-size:30px;font-family:Tahoma;color:#082E54;font-weight: bold">
                World Mobility & Mortality During COVID-19
        </p>
    </center>

    <div class="chart-wrapper" id="chart-line1">
        <div id="mobility"></div>
        <p>
            <font size="4" face="Arial">
                Male life expectancy in the selected ten countries are rendered below. Note that most countries, especially those developed coutries, have a steady increase of life expectancy from year 2000 to year 2012. Also note the significant increase of life expectancy for Zimbabwe which indicate an improving health condition in that country. However, a significant decrease of life expectancy can also be observed for Iraq. 
            </font>
        </p>
    </div>

    <script>

    // set the dimensions and margins of the graph
    var margin = {top: 50, right: 50, bottom: 100, left: 50},
        width = 800 - margin.left - margin.right,
        height = 600 - margin.top - margin.bottom;

    var svg = d3.select("#mobility")
      .append("svg")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
      .append("g")
        .attr("transform",
              "translate(" + margin.left + "," + margin.top + ")");
              
    d3.csv("https://raw.githubusercontent.com/jayw11/jayw11.github.io/master/covid19.csv", function(data) {

      var x = d3.scaleLinear()
        .domain([-450, 350])
        .range([ 0, width ]);
      svg.append("g")
        .attr("transform", "translate(0," + height + ")")
        .call(d3.axisBottom(x));
      svg.append("text")             
          .attr("transform",
                "translate(" + (width/2) + " ," + 
                               (height + margin.top + 20) + ")")
          .style("text-anchor", "middle")
          .text("Mobility");
          
      var y = d3.scaleLog()
        .domain([0.1, 850])
        .range([height,0]);
      svg.append("g")
        .call(d3.axisLeft(y));
      svg.append("text")
          .attr("transform", "rotate(-90)")
          .attr("y", 0 - margin.left)
          .attr("x",0 - (height / 2))
          .attr("dy", "1em")
          .style("text-anchor", "middle")
          .text("Total Death Per Million");
          
      var color = d3.scaleOrdinal()
        .domain(["Asia", "Oceania", "Africa", "NorthAmerica", "Europe", "SouthAmerica" ])
        .range([ "#FFD700", "#4169E1", "#802A2A", "#7CFC00", "8A2BE2", "FF6347"])

      var tooltip = d3.select("#mobility")
        .append("div")
        .style("opacity", 0)
        .attr("class", "tooltip")
        .style("background-color", "white")
        .style("border", "solid")
        .style("border-width", "1px")
        .style("border-radius", "5px")
        .style("padding", "10px")
        
      var mouseover = function(d){
        continents = d.continent
        d3.selectAll(".dot")
          .transition()
          .duration(100)
          .style("fill", "grey")
          .attr("r", 3)

        d3.selectAll("." + continents)
          .transition()
          .duration(100)
          .style("fill", color(continents))
          .attr("r", 7)
          
        tooltip
          .html("Country Name: " + d.location)
          .style("left", (d3.mouse(this)[0]+90) + "px") 
          .style("top", (d3.mouse(this)[1]) + "px")
          .style("opacity", 1)
      }

      var mouseleave = function(){
        d3.selectAll(".dot")
          .transition()
          .duration(100)
          .style("fill", "grey")
          .attr("r", 5 )
          
        tooltip
          .transition()
          .duration(200)
          .style("opacity", 0)
      }
        
      var mousemove = function(d) {
        tooltip
          .html("Country Name: " + d.location)
          .style("top", d3.select(this).attr("cy") + "px")
            .style("left", d3.select(this).attr("cx") + "px")
      }
      
      // Add dots
      svg.append('g')
        .selectAll("dot")
        .data(data)
        .enter()
        .append("circle")
          .attr("class", function (d) { return "dot " + d.continent } )
          .attr("cx", function (d) { return x(d.mobility); } )
          .attr("cy", function (d) { return y(d.deaths_per_million); } )
          .attr("r", 5)
          .style("fill", function (d) { return color(d.continent) } )
        .on("mouseover", mouseover)
        .on("mousemove", mousemove)
        .on("mouseleave", mouseleave )
        .bind("#chart-line1");

    })

    </script>

    <center>
        <p></p>
        <a class="button1" href="index.html" style="margin-right: 200px">Previous</a>
        <font size="3" face="Arial Black">
                <a class="scene1" href="page2-1.html">Scene 2-1</a>
                |
                <a class="scene2" href="page2-2.html">Scene 2-2</a>
                |
                <a class="scene2" href="page2-3.html">Scene 2-3</a>
            </font>
        <a class="button1" href="page3-1.html" style="margin-left: 200px" >Next</a>
    </center>
</body>
</html>